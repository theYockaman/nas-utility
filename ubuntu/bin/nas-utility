#!/usr/bin/env bash

set -euo pipefail
IFS=$'\n\t'

# ----------------------
# Helper Functions
# ----------------------
APP_NAME="nas-utility"
source "/usr/local/lib/$APP_NAME/utils.sh"



# --- Global argument parser ---
parse_global_args() {
    while [[ $# -gt 0 ]]; do
        case "$1" in
            --whiptail)
                WHIPTAIL=true
                shift
                ;;
            -*)
                echo "Unknown global option: $1" >&2
                exit 1
                ;;
            *)
                COMMAND="$1"
                shift
                ARGS=("$@")
                break
                ;;
        esac
    done
}


#!/bin/bash

WHIPTAIL=false
COMMAND=""
ARGS=()




install(){
    


}




main() {

    parse_global_args "$@"

    # Define mapping between actions and functions
    declare -A ACTIONS=(
        ["install"]="install_menu"
        ["uninstall"]="uninstall_menu"
        ["delete"]="delete_app"
        ["exit"]="exit_program"
    )

    if $WHIPTAIL; then
        
        # Check if Whiptail is installed
        if ! command -v whiptail &> /dev/null; then
            sudo apt update
            sudo apt install whiptail -y
        fi


        while true; do
            CHOICE=$(whiptail --title "Action Menu" --menu "Choose an option:" 20 60 10 \
                "install" "Install application" \
                "uninstall" "Uninstall application" \
                "delete" "Delete application" \
                "exit" "Exit program" \
                3>&1 1>&2 2>&3)

            exitstatus=$?
            if [ $exitstatus -ne 0 ] || [ -z "$CHOICE" ]; then
                echo "No selection made. Exiting."
                break
            fi

            if [[ -n "${ACTIONS[$CHOICE]}" ]]; then
                "${ACTIONS[$CHOICE]}" "${ARGS[@]}"
            else
                whiptail --title "Error" --msgbox "Invalid option selected!" 10 50
            fi
        done
    else
        if [[ -n "${ACTIONS[$COMMAND]}" ]]; then
            "${ACTIONS[$COMMAND]}" "${ARGS[@]}"
        else
            echo "Usage: $0 <command> [options]"
            echo
            echo "Commands:"
            for cmd in "${!ACTIONS[@]}"; do
                printf "  %-10s\n" "$cmd"
            done
            echo
            echo "Options:"
            echo "  --whiptail   Enable interactive prompts"
            exit 1
        fi
    fi
}

main "$@"




